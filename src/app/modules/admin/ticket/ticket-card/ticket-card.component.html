<div class="flex flex-col" style="max-height: 90vh;">
    <div class="flex flex-col overflow-y-auto p-6">

        <div class="flex flex-row justify-between items-center">
            <div class="flex flex-row items-center" *ngIf="!this.data">
                <div class="text-3xl font-bold mr-5">สร้าง Ticket</div>
                <!-- <div class="text-base">(ID: 2221)</div> -->
            </div>
            <div class="flex flex-row items-center" *ngIf="this.data">
                <div class="text-3xl font-bold mr-5">รายละเอียด</div>
                <div class="text-base">(ID: {{this.data.code}})</div>
            </div>
            <div class="flex flex-row items-center justify-center">
                <mat-form-field class="min-w-56 mt-4">
                    <mat-select (selectionChange)="changeStatus($event)" [formControl]="statusData">
                        <mat-option class="border-b-2">เลือกสถานะ</mat-option>
                        <mat-option value="Process">กำลังดำเนินงาน</mat-option>
                        <mat-option value="Waiting">รอเข้ารับบริการ</mat-option>
                        <mat-option value="Finish">เสร็จสิ้น</mat-option>
                        <mat-option value="Cancel">ยกเลิก</mat-option>
                    </mat-select>
                </mat-form-field>
                &nbsp;
                &nbsp;
                <button mat-icon-button [tabIndex]="-1" (click)="onClose()">
                    <mat-icon class="text-current" [svgIcon]="'heroicons_outline:x-mark'"></mat-icon>
                </button>
            </div>
        </div>

        <form [formGroup]="form">
            <div class="flex flex-col">
                <mat-form-field class="flex-auto w-full">
                    <mat-label class="font-bold">ข้อมูลรถ</mat-label>
                    <mat-select formControlName="car_id">
                        <mat-option value="">เลือกรถ</mat-option>
                        <mat-option value="{{item.id}}"
                            *ngFor="let item of productData; let i = index">{{item.license}}</mat-option>
                    </mat-select>
                    <!-- <mat-icon matSuffix>search</mat-icon>

                <input type="text" placeholder="เลือกรถ" matInput [formControl]="ProductControl" [matAutocomplete]="product" [(ngModel)]="selectedProduct"/>
                <button *ngIf="selectedProduct" matSuffix mat-icon-button aria-label="Clear" (click)="selectedProduct = ''">
                    <mat-icon>close</mat-icon>
                </button>
                <mat-autocomplete #product="matAutocomplete" [displayWith]="displayProduct.bind(this)">
                    <mat-option *ngFor="let option of filteredOptionsProduct | async" [value]="option.id">
                        {{ option.license }}
                    </mat-option>
                </mat-autocomplete> -->
                </mat-form-field>
            </div>

            <div class="flex flex-col">
                <mat-label class="font-bold">วันที่นัดหมาย</mat-label>
                <div class="flex flex-row gap-3 ">
                    <mat-form-field class="flex-auto w-1/2">
                        <input matInput [matDatepicker]="picker1" [placeholder]="'ระบุวัน'" formControlName="date">
                        <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                        <mat-datepicker #picker1></mat-datepicker>
                    </mat-form-field>
                    <div class="w-1/2">
                        <mat-form-field class="flex-auto w-full">
                            <mat-select formControlName="time">
                                <mat-option value="">เลือกเวลา</mat-option>
                                <mat-option value="{{time}}"
                                    *ngFor="let time of timeOptions; let i = index">{{time}}</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
            </div>

            <div class="flex flex-col mb-6" *ngIf="!this.data">
                <mat-label class="font-bold">รายละเอียดแจ้งซ่อม</mat-label>
                <div class="grid grid-cols-4 gap-4">
                    <div *ngFor="let item of serviceData" class="relative w-30 h-30">
                        <input id="myCheck_{{item.name}}" class="absolute top-0 right-0 m-2" type="checkbox"
                            (change)="addFeature(item.id)" [checked]="isChecked(item.id)">
                        <label for="myCheck_{{item}}" class="w-fit cursor-pointer">
                            <div
                                class="flex items-center checkbox-card justify-center w-30 h-30 bg-white rounded-md select-none pointer-events-none">
                                <div class="flex flex-col items-center">
                                    <img class="max-w-13 max-h-13" src="{{item.image}}" alt="เช็คระยะ">
                                    <h1>{{item.name}}</h1>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>

            </div>
            <div class="flex flex-col mb-6" *ngIf="this.data">
                <mat-label class="font-bold">รายละเอียดแจ้งซ่อม</mat-label>
                <!-- main.component.html -->
                <app-checkbox-service [items]="this.serviceData" [dataArray]="this.testData"></app-checkbox-service>
                <!-- <app-checkbox-service [items]="yourArray" [dataArray]="yourDataArray"></app-checkbox-service> -->


            </div>

            <div class="flex flex-col">
                <mat-label class="font-bold">ศูนย์บริการ</mat-label>
                <mat-form-field>
                    <mat-select formControlName="service_center_id">
                        <mat-option value="">เลือกศูนย์บริการ</mat-option>
                        <mat-option [value]="item.id"
                            *ngFor="let item of serviceCenterData; let i = index">{{item.name}}</mat-option>
                    </mat-select>
                </mat-form-field>
            </div>
            <div class="flex flex-col">
                <mat-label class="font-bold">ข้อมูลลูกค้า</mat-label>
  
                <mat-form-field>
                    <mat-select (selectionChange)="onChangeClient($event)" formControlName="client_id">
                        <mat-option value="">เลือกลูกค้า</mat-option>
                        <mat-option [value]="item.id"
                            *ngFor="let item of clientData; let i = index">{{item.name}}</mat-option>
                    </mat-select>
                </mat-form-field>
                <mat-form-field class="flex-auto">
                    <input matInput [placeholder]="'เบอร์โทรศัพท์ติดต่อ'" formControlName="phone">
                </mat-form-field>
            </div>

            <div class="flex flex-col">
                <div class="flex flex-row justify-between mb-6">
                    <mat-label class="font-bold">Activity</mat-label>
                    <div class="flex flex-row cursor-pointer">
                        <img class="w-5 h-5" src="assets/images/sort-ascending.png" alt="">
                        <h1 class="text-red-500">
                            เรียงจากหน้าใหม่ไปเก่า</h1>
                    </div>
                </div>
                <ol>
                    <ng-container *ngFor="let item of testData">
                        <li class="flex flex-row min-h-20">
                            <div class="flex flex-col items-center">
                                <div class="flex w-10 h-10 mr">
                                    <img class="rounded-full" src="assets/images/avatars/female-18.jpg" alt="">
                                </div>
                                <div class="w-0.5 h-full bg-[#EAECF0]"></div>
                            </div>
                            <div class="flex flex-col ml-5 mb-10">
                                <h2><b>{{item.create_by ?? 'admin'}}</b> {{(item.created_at) ?? '2 min ago'}}</h2>
                                <h2 class="text-[#667085]">{{item.status}}</h2>
                            </div>
                        </li>
                    </ng-container>
                </ol>
            </div>
        </form>
        <button class="px-6 rounded-md mt-5" mat-flat-button [color]="'primary'"
            (click)="onSaveClick()">บันทึก</button>
    </div>
</div>